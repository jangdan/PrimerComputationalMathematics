---
redirect_from:
  - "/geosciences/tides"
interact_link: notebooks/geosciences/Tides.ipynb
kernel_name: python3
kernel_path: notebooks/geosciences
has_widgets: false
title: |-
  Tides
pagenum: 33
prev_page:
  url: /geosciences/Seismology.html
next_page:
  url: /geosciences/Wave_dispersion.html
suffix: .ipynb
search: r frac big cos phi omega g omegap force p cp moon sin dl earth tgf mm partial t m phip tide mathbf potential img src images png alt style width px term c tidal its f point gradient horizontal h diurnal tides period sim days per direction not surface gmm graph above frequencies rotate highs n distance does earths rightarrow terms generating need lets plot eq angle hour species lunar cycle semi hr cycles spring neap very sea mass once high however reality lows recall gravitational results hat where times between masses unit scalar nabla field depend only moons

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /notebooks***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Tides</div>
</div>
    
<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Tides">Tides<a class="anchor-link" href="#Tides"> </a></h1><p>Tides are very long wavelength and period waves and are characterised by rhythmic rise and fall of sea level over $\sim$ 0.5 day or $\sim$ full day. Tidal currents are generated by the Moon and the Sun. Tides are regular and can be predicted.</p>
<p>Earth and Moon rotate about its common centre of mass with a period of $\sim$ 27.3 days. Earth rotates around its axis once per day, so we would expect one high and one low tide. However, in reality there are two highs and two lows per day.</p>
<h2 id="Tide-genereting-force-(TGF)">Tide-genereting force (TGF)<a class="anchor-link" href="#Tide-genereting-force-(TGF)"> </a></h2><p>Recall that gravitational attraction results in a force:
$$\mathbf{F}=G\frac{m_1m_2}{r^2}\hat{\mathbf{r}},$$
where $G=6.67\times10^{-11}\,N\,m^2\,kg^{-2}$, $r$ the distance between point masses $m_1$ and $m_2$ and $\hat{\mathbf{r}}$ is the unit vector in the direction connecting two masses. This force per unit mass can be expressed as a gradient of a scalar potential:
$$\mathbf{F}=-\nabla \Omega$$
because gravitational field is conservative, meaning the total work done to move an object in the presence of that field does not depend on the path.</p>
<p>Assuming $\mathbf{F}$ is the force from the Moon exerted on Earth and only varies in the radial direction:
$\Omega = -G \frac{m_M}{r}$.</p>
<p>We would like to find Moon's gravity influence on an arbitrary point $P$ at Earth's surface:</p>
<p><img src="../images/tides_earth_moon.png" alt="TGF Earth-Moon" style="width:400px;"/></p>
<p>From the cosine law, we know:</p>
$$r_1^2=r^2+R^2-2rR\cos{\phi}\Rightarrow r_1^2=R^2\Big(1-2\frac{r}{R}\cos{\phi}+\Big(\frac{r}{R}\Big)^2\Big)$$<p>We can insert $r_1$ into potential scalar at point $P$:</p>
$$\Omega_P = -G\frac{m_M}{R}\Big[1-2\frac{r}{R}\cos{\phi}+\Big(\frac{r}{R}\Big)^2\Big]^{-1/2}$$<p>We can expand the terms in the brackets with Legendre polynomials:
$$\Omega_P = -G\frac{m_M}{R}\Big[1+\Big(\frac{r}{R}\Big)P_1(\cos{\phi})+\Big(\frac{r}{R}\Big)^2 P_2(\cos{\phi})+\Big(\frac{r}{R}\Big)^3 P_3(\cos{\phi})+...\Big],\\
P_1(\cos{\phi})=\cos{\phi},\\
P_2(\cos{\phi})=\frac{1}{2}(3\cos^2{\phi}-1),\\
P_3(\cos{\phi})=\frac{1}{2}(5\cos^3{\phi}-3\cos{\phi}).$$</p>
<p>Since we know the Earth's radius and distance to the Moon, their ratio can be approximated as $\frac{r}{R}\approx \frac{1}{60} \ll 1$. Therefore, any higher order terms in the expansion will become very small and can be ignored.</p>
<p>To find the tide-generating force, we need to take the gradient of this potential and its first three terms:
$$\mathbf{F_p}=-\nabla\Omega_p,\quad \Omega_P = -G\frac{m_M}{R}\Big[1+\Big(\frac{r}{R}\Big)\cos{\phi}+\Big(\frac{r}{R}\Big)^2\frac{1}{2}(3\cos^2{\phi}-1)+...\Big].$$</p>
<p>The first term is a constant so its gradient is zero, it produces no force.</p>
<p>The second term needs to be differentiated with respect to $r\cos{\phi}$ (the "x" direction) and is a constant:
$$-\frac{\Omega_P}{\Omega(r\cos{\phi})}=\frac{Gm_M}{R^2}.$$
It acts in the direction along $R$ on the graph and is the centripetal acceleration.</p>
<p>The final term in the potential creates a <strong>tide-generating force</strong>:
$$\Omega_P = -\frac{1}{2}Gm_M \frac{r^2}{R^3}(3\cos^2{\phi}-1).$$
To get the vertical and horizontal force, we need to differentiate it with respect to $r$ and $\phi$:
$$F_{P}^{vert} = -\frac{\partial \Omega_P}{\partial r}=G m_M\frac{r}{R^3}(3\cos^2{\phi}-1),\\
F_{P}^{horiz}=-\frac{\partial\Omega_P}{r\partial\phi}=-\frac{6}{2}Gm_M \frac{r}{R^3}\cos{\phi}\sin{\phi}=-\frac{3}{2}Gm_M \frac{r}{R^3}\sin{2\phi}.$$</p>
<p>The tide-generating force is inversely proportional to the cubic distance from the Earth to the Moon.</p>
<p>Let's calculate the vertical and horizontal forces for point London at $51^\circ$N:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">def</span> <span class="nf">VerticalTGF</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">mass_moon</span><span class="p">,</span> <span class="n">planet_radius</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">G</span><span class="o">*</span><span class="n">mass_moon</span><span class="o">*</span><span class="n">planet_radius</span><span class="o">/</span><span class="n">distance</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> 

<span class="k">def</span> <span class="nf">HorizontalTGF</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">mass_moon</span><span class="p">,</span> <span class="n">planet_radius</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mf">2.</span><span class="o">*</span><span class="n">G</span><span class="o">*</span><span class="n">mass_moon</span><span class="o">*</span><span class="n">planet_radius</span><span class="o">/</span><span class="n">distance</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">lat</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">TidalPotential</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">mass_moon</span><span class="p">,</span> <span class="n">planet_radius</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">lat</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">G</span><span class="o">*</span><span class="n">mass_moon</span><span class="o">*</span><span class="p">(</span><span class="n">planet_radius</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">distance</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">lat</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">G</span> <span class="o">=</span> <span class="mf">6.67e-11</span>          <span class="c1"># Gravitational constant</span>
<span class="n">mass_m</span> <span class="o">=</span><span class="mf">7.34767309e22</span> <span class="c1"># Moon&#39;s mass</span>
<span class="n">r</span> <span class="o">=</span> <span class="mi">6378000</span>           <span class="c1"># Earth&#39;s radius</span>
<span class="n">R</span> <span class="o">=</span> <span class="mi">384400000</span>         <span class="c1"># Earth-Moon distance</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">deg2rad</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span>  <span class="c1"># Latitude</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vertical force (N) = &quot;</span><span class="p">,</span> <span class="n">VerticalTGF</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">mass_m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">phi</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Horizontal force (N) = &quot;</span><span class="p">,</span> <span class="n">HorizontalTGF</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">mass_m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">phi</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Vertical force (N) =  1.0353180375515302e-07
Horizontal force (N) =  -8.074315039381746e-07
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Horizontal force can change its sign when $\phi$ is zero and when $\phi = \pm\pi/2$. This explains why it has two bulges on Earth's surface.</p>
<p><img src="../images/tides_forces.png" alt="TGF" style="width:400px;"/></p>
<p>Let's plot how these forces change with latitude ($\phi$):</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">HorizontalTGF</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">mass_m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span>
         <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Horizontal force&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">VerticalTGF</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">mass_m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">phi</span><span class="p">),</span>
         <span class="n">c</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Verical force&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/geosciences/Tides_4_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create a range of points on Earth surface</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">r</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="c1"># Create outer shell of 4000 km </span>
<span class="c1"># depth (ocean) and scale by a factor of 200</span>
<span class="c1"># so it is noticable</span>
<span class="n">factor</span> <span class="o">=</span> <span class="mi">200</span>
<span class="n">r2</span> <span class="o">=</span> <span class="n">r</span> <span class="o">+</span> <span class="n">factor</span><span class="o">*</span><span class="mi">4000</span>
<span class="n">x2</span> <span class="o">=</span> <span class="n">r2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">r2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

<span class="c1"># Create how Earth&#39;s surface deforms</span>
<span class="c1"># and scale by factor of 10,000</span>
<span class="n">factor2</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="mi">10000</span>
<span class="n">r3</span> <span class="o">=</span> <span class="n">r2</span> <span class="o">-</span> <span class="n">factor2</span><span class="o">*</span><span class="n">TidalPotential</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">mass_m</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">R</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span><span class="o">/</span><span class="mf">9.8</span>
<span class="n">x3</span> <span class="o">=</span> <span class="n">r3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">y3</span> <span class="o">=</span> <span class="n">r3</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x3</span><span class="p">,</span> <span class="n">y3</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span>
         <span class="n">label</span><span class="o">=</span><span class="s2">&quot;equilibrium tidal</span><span class="se">\n</span><span class="s2">perturbation&quot;</span><span class="p">)</span>

<span class="n">circle1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">r2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ocean&quot;</span><span class="p">)</span>
<span class="n">circle2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">Circle</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">circle1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">circle2</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;&quot;Water depth and</span>
<span class="s2">equilibrium tidal</span>
<span class="s2">perturbation</span>
<span class="s2">massively</span>
<span class="s2">exaggerated&quot;&quot;&quot;</span><span class="p">,</span>
        <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s2">&quot;center&quot;</span><span class="p">,</span>
         <span class="n">fontweight</span><span class="o">=</span><span class="s2">&quot;bold&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">1.2e7</span><span class="p">,</span> <span class="mf">1e7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/geosciences/Tides_6_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Horizontal force can be balanced by the sea surface gradient term $g\times grad(h)$. This is called equilibrium tide - the free surface elevation of water-covered Earth whose pressure gradient balances horizontal TGF and results in steady balanced state:
$$g\frac{1}{r}\frac{\partial h}{\partial \phi}=-\frac{1}{r}\frac{\partial \Omega_P}{\partial \phi}\Rightarrow h_{eq}=-\frac{\Omega_P}{g}.$$</p>
<p>For Moon $h_{eq}\sim 0.27$ m. However, Earth is not entirely water covered so we don't have an equilibirium state in reality. The tidal bulges would rotate with Earth once every 24 hours but land gets in the way.</p>
<p>Moon does not rotate exactly above the equator, so our equations need to be corrected for the angle $d_l$ (declination of the Moon north of the equator) and $C_p$ (the Moon's "hour" angle):</p>
<p><img src="../images/tides_moon_declination.png" alt="TGF" style="width:600px;"/></p>
<p>Therefore, the new formula for potential is:
$$\Omega_P = -\frac{1}{4}G m_M \frac{r^2}{R^3}[(3\sin^2{d_l}-1)(3\sin^2{\phi_P}-1)+\sin{2d_l}\sin{2\phi_P}\cos{C_P}+\cos^2{d_l}\cos^2{\phi_P}\cos{2C_P}].$$
Recall that $g=\frac{GM_E}{r^2}$ and $h_eq=-\frac{\Omega_P}{g}$:
$$h_{eq}(C_P,\phi_P, t)=r\frac{m_M}{M_E}\Big[C_0(t) \Big(\frac{3}{2}\sin^2{\phi_P}-\frac{1}{2}\Big)+C_1(t)\sin{2\phi_P}+C_2(t)\cos^2{\phi_P}\Big],\\
C_0(t) = \Big(\frac{r}{R}\Big)^3 \Big(\frac{3}{2}\sin^2{d_l}-\frac{1}{2}\Big),\\
C_1(t) = \Big(\frac{r}{R}\Big)^3 \Big(\frac{3}{4}\sin{2d_l}\cos{C_P}\Big),\\
C_2(t) = \Big(\frac{r}{R}\Big)^3 \Big(\frac{3}{4}\cos^2{2d_l}\cos{2C_P}\Big).$$</p>
<p>Let's look at the time-dependent coefficients:</p>
<ol>
<li>First one does not vary with $C_P$, only depend on declination $d_l$. These are called the <strong>long-period tides or species</strong>.</li>
<li>Second term also depends on $d_l$ at twice the frequency as above, but also includes <strong>diurnal species</strong> at frequency one per lunar cycle ($\cos{C_P}$ factor).</li>
<li>Final term includes <strong>semi-diurnal species</strong> due to $\cos{2C_P}$ factor.</li>
</ol>
<p>Lunar hour angle $C_P$ is the difference between longitude of point $P$ and location with the Moon directly overhead. It can be calculated from"
$$C_P=\omega_1 t +\lambda_P,$$
where $\omega_1=\frac{360^\circ}{24.8412 \text{hr}}=14.4921^\circ$ hr$^{-1}$.</p>
<p>Doodson expanded tidal potential above with Fourier series using fundamental frequencies:</p>
$$\omega=n_1\omega_1+n_2\omega_2+...+n_6 \omega_6$$<p>These frequencies are known and can be looked up in a table.</p>
<p><img src="../images/tides_frequencies_1.png" alt="TGF" style="width:600px;"/>
<img src="../images/tides_frequencies_2.png" alt="TGF" style="width:600px;"/></p>
<h2 id="Tidal-frequencies">Tidal frequencies<a class="anchor-link" href="#Tidal-frequencies"> </a></h2><p>The combination of the six fundamental frequencies mentioned above can be used to find important cycles - semi-diurnal cycle ($\omega_1=12.42$ hr), spring/neap cycle ($\omega_0-\omega_1=14.75$ days).</p>
<p>Spring-neap cycles can be explained via superposition of the principal lunar and principal solar tidal constituents: $\omega_0-\omega_1=\omega_2-\omega_3 \rightarrow M_2, S_2.$</p>
<p><img src="../images/tides_principal_constituents.png" alt="TGF" style="width:600px;"/></p>
<p>Using $M_2$ and $S_2$, we can plot semi-diurnal and spring-neap cycles:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">24</span><span class="o">*</span><span class="mi">30</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>

<span class="n">M2</span> <span class="o">=</span> <span class="mf">0.242334</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="mf">14.4921</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>
<span class="n">S2</span> <span class="o">=</span> <span class="mf">0.112841</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="mf">14.4921</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.549</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="mf">0.0411</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>

<span class="n">plots</span> <span class="o">=</span> <span class="p">[</span><span class="n">M2</span><span class="p">,</span> <span class="n">S2</span><span class="p">,</span> <span class="n">M2</span><span class="o">+</span><span class="n">S2</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$M_2: a_</span><span class="si">{M_2}</span><span class="s2"> \cos(2\omega_1 \frac{\pi}</span><span class="si">{180}</span><span class="s2"> t)$&quot;</span><span class="p">,</span>
         <span class="sa">r</span><span class="s2">&quot;$S_2: a_</span><span class="si">{S_2}</span><span class="s2">\cos([2\omega_1+2\omega_2-2\omega_3]\frac{\pi}</span><span class="si">{180}</span><span class="s2">t)$&quot;</span><span class="p">,</span>
         <span class="s2">&quot;$M_2+S_2$&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mf">24.</span><span class="p">,</span> <span class="n">plots</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitude&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Days&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Semi-diurnal and Spring-Neap cycles</span><span class="se">\n</span><span class="s2">(M2 and S2)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/geosciences/Tides_8_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The top graph shows 57 highs in 30 days, while the middle graph shows 60 highs in 30 days.</p>
<p>Then we can plot diurnal inequality - $M_2$ and $K_1$:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">M2</span> <span class="o">=</span> <span class="mf">0.242334</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="mi">2</span><span class="o">*</span><span class="mf">14.4921</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>
<span class="n">K1</span> <span class="o">=</span> <span class="mf">0.141565</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">((</span><span class="mi">1</span><span class="o">*</span><span class="mf">14.4921</span> <span class="o">+</span> <span class="mi">1</span><span class="o">*</span><span class="mf">0.549</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">180</span><span class="p">)</span><span class="o">*</span><span class="n">t</span><span class="p">);</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>

<span class="n">plots</span> <span class="o">=</span> <span class="p">[</span><span class="n">M2</span><span class="p">,</span> <span class="n">K1</span><span class="p">,</span> <span class="n">M2</span><span class="o">+</span><span class="n">K1</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">r</span><span class="s2">&quot;$M_2: a_</span><span class="si">{M_2}</span><span class="s2"> \cos(2\omega_1 \frac{\pi}</span><span class="si">{180}</span><span class="s2"> t)$&quot;</span><span class="p">,</span>
         <span class="sa">r</span><span class="s2">&quot;$K_1: a_</span><span class="si">{K_1}</span><span class="s2">\cos([\omega_1+\omega_2]\frac{\pi}</span><span class="si">{180}</span><span class="s2">t)$&quot;</span><span class="p">,</span>
         <span class="s2">&quot;$M_2+K_1$&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="o">/</span><span class="mf">24.</span><span class="p">,</span> <span class="n">plots</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper right&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitude&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Days&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Diurnal inequality</span><span class="se">\n</span><span class="s2">(M2 and K1)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/geosciences/Tides_10_0.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can see on the bottom graph that it has high and lows of different magnitudes within a 24 hour period.</p>
<p><strong>References:</strong></p>
<ul>
<li>The information in this notebook was compiled based on Geophysical Fluid Dynamics for the Oceans course at ESE</li>
</ul>

</div>
</div>
</div>
</div>

 


    </main>
    